/*! For license information please see danmaku-wall.7ebf8982.js.LICENSE.txt */
"use strict";(self.webpackChunktrain_ts=self.webpackChunktrain_ts||[]).push([[568],{5230:function(e,n,t){var r,o=t(2791),u=t(1250),c=t(8983),a=(t(9829),t(3433)),i=t(9439),f=t(1413),l=t(4164),s=t(184);function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return Math.round(Math.random()*(n-e))+e}function m(e){var n=e.words,t=e.container,r=e.duration,u=e.onEnd,c=(0,o.useState)(),a=(0,i.Z)(c,2),f=a[0],l=a[1],m=(0,o.useRef)(null),y=(0,o.useRef)(1e3*(r||d(5,10))),p=(0,o.useState)("move"),v=(0,i.Z)(p,2),b=v[0],h=v[1],g=(0,o.useRef)(0),j=(0,o.useRef)(0),O=(0,o.useRef)(0);(0,o.useEffect)((function(){var e=m.current,n=t||document.getElementById("screen");if(e&&n){var r=d(14,28),o="#"+Math.floor(16777215*Math.random()).toString(16),u=-e.clientWidth,c=d(0,n.clientHeight-e.clientHeight);l({fontSize:r,color:o,right:u,top:c}),O.current=n.clientWidth-u}}),[t]),(0,o.useEffect)((function(){var e=m.current;if("pause"!==b&&e&&t){var n=O.current,r=y.current,o=0,c=0;return c=requestAnimationFrame((function t(a){g.current=g.current||a;var i=g.current,f=j.current;o=n*(f=f+a-i)/r,o=Math.min(o,n),e.style.transform="translateX(-"+o+"px)",g.current=a,j.current=f,f<r?c=requestAnimationFrame(t):setTimeout((function(){u&&u()}),0)})),function(){c&&cancelAnimationFrame(c)}}}),[t,u,b]);var Z=(0,o.useCallback)((function(){h("pause")}),[]),w=(0,o.useCallback)((function(){h("move"),g.current=0}),[]);return(0,s.jsx)("span",{ref:m,className:"danmaku",style:f,onMouseEnter:Z,onMouseOut:w,children:n})}var y=function(e){var n=function(n){var t=(0,o.useMemo)((function(){var e=document.getElementById("screen");return e||((e=document.createElement("div")).id="screen",e.classList.add("screen"),document.body.appendChild(e)),e}),[]);return l.createPortal((0,s.jsx)(e,(0,f.Z)((0,f.Z)({},n),{},{container:t})),t)};return(0,o.memo)(n)}(m),p=(0,o.memo)(m);y.launch=function(e){var n=(0,o.forwardRef)((function(n,t){return(0,s.jsx)(y,(0,f.Z)({},e))}));(r=r||u.createRoot(document.getElementById("screen"))).render((0,s.jsx)(n,{}))};var v=function(){var e=(0,o.useRef)(""),n=(0,o.useRef)(0),t=(0,o.useRef)(null),r=(0,o.useState)([]),u=(0,i.Z)(r,2),c=u[0],f=u[1],l=(0,o.useCallback)((function(){e.current&&f((function(t){return[].concat((0,a.Z)(t),[{id:n.current++,words:e.current}])}))}),[]),d=(0,o.useCallback)((function(){f([])}),[]),m=(0,o.useCallback)((function(n){e.current=n.target.value}),[]),y=(0,o.useCallback)((function(e){f((function(n){return n.filter((function(n){return e.id!==n.id}))}))}),[]);return(0,s.jsxs)("div",{className:"danmaku-wall",children:[(0,s.jsx)("div",{ref:t,id:"screen",className:"screen",children:c.map((function(e){return(0,s.jsx)(p,{words:e.words,container:t.current,onEnd:function(){return y(e)}},e.id)}))}),(0,s.jsxs)("div",{className:"text-center control-panel",children:[(0,s.jsx)("input",{type:"text",placeholder:"\u8bf7\u8f93\u5165\u5f39\u5e55\u5185\u5bb9",maxLength:50,onChange:m}),(0,s.jsxs)("div",{children:[(0,s.jsx)("button",{className:"primary",type:"button",onClick:l,children:"\u53d1\u5c04"}),(0,s.jsx)("button",{className:"clean",type:"button",onClick:d,children:"\u6e05\u5c4f"})]})]})]})};u.createRoot(document.getElementById("root")).render((0,s.jsx)(o.StrictMode,{children:(0,s.jsx)(v,{})})),(0,c.Z)()},8983:function(e,n,t){n.Z=function(e){e&&e instanceof Function&&t.e(787).then(t.bind(t,787)).then((function(n){var t=n.getCLS,r=n.getFID,o=n.getFCP,u=n.getLCP,c=n.getTTFB;t(e),r(e),o(e),u(e),c(e)}))}},1250:function(e,n,t){var r=t(4164);n.createRoot=r.createRoot,n.hydrateRoot=r.hydrateRoot},6374:function(e,n,t){var r=t(2791),o=Symbol.for("react.element"),u=Symbol.for("react.fragment"),c=Object.prototype.hasOwnProperty,a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function f(e,n,t){var r,u={},f=null,l=null;for(r in void 0!==t&&(f=""+t),void 0!==n.key&&(f=""+n.key),void 0!==n.ref&&(l=n.ref),n)c.call(n,r)&&!i.hasOwnProperty(r)&&(u[r]=n[r]);if(e&&e.defaultProps)for(r in n=e.defaultProps)void 0===u[r]&&(u[r]=n[r]);return{$$typeof:o,type:e,key:f,ref:l,props:u,_owner:a.current}}n.Fragment=u,n.jsx=f,n.jsxs=f},184:function(e,n,t){e.exports=t(6374)},9829:function(){},907:function(e,n,t){function r(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}t.d(n,{Z:function(){return r}})},3878:function(e,n,t){function r(e){if(Array.isArray(e))return e}t.d(n,{Z:function(){return r}})},4942:function(e,n,t){function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}t.d(n,{Z:function(){return r}})},9199:function(e,n,t){function r(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}t.d(n,{Z:function(){return r}})},5267:function(e,n,t){function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}t.d(n,{Z:function(){return r}})},1413:function(e,n,t){t.d(n,{Z:function(){return u}});var r=t(4942);function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function u(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}},9439:function(e,n,t){t.d(n,{Z:function(){return c}});var r=t(3878);var o=t(181),u=t(5267);function c(e,n){return(0,r.Z)(e)||function(e,n){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,o,u=[],c=!0,a=!1;try{for(t=t.call(e);!(c=(r=t.next()).done)&&(u.push(r.value),!n||u.length!==n);c=!0);}catch(i){a=!0,o=i}finally{try{c||null==t.return||t.return()}finally{if(a)throw o}}return u}}(e,n)||(0,o.Z)(e,n)||(0,u.Z)()}},3433:function(e,n,t){t.d(n,{Z:function(){return c}});var r=t(907);var o=t(9199),u=t(181);function c(e){return function(e){if(Array.isArray(e))return(0,r.Z)(e)}(e)||(0,o.Z)(e)||(0,u.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},181:function(e,n,t){t.d(n,{Z:function(){return o}});var r=t(907);function o(e,n){if(e){if("string"===typeof e)return(0,r.Z)(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?(0,r.Z)(e,n):void 0}}}},function(e){var n;n=5230,e(e.s=n)}]);
//# sourceMappingURL=danmaku-wall.7ebf8982.js.map