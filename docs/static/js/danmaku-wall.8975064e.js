/*! For license information please see danmaku-wall.8975064e.js.LICENSE.txt */
"use strict";(self.webpackChunktrain_ts=self.webpackChunktrain_ts||[]).push([[568],{4292:function(e,t,n){var r=n(2791),o=n(1250),u=n(8983),c=(n(9829),n(907));var a=n(181);function i(e){return function(e){if(Array.isArray(e))return(0,c.Z)(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||(0,a.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var l,f=n(885),s=n(8683),d=n(4164),m=n(184);function y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return Math.round(Math.random()*(t-e))+e}function p(e){var t=e.words,n=e.container,o=e.duration,u=e.onEnd,c=(0,r.useState)(),a=(0,f.Z)(c,2),i=a[0],l=a[1],s=(0,r.useRef)(null),d=(0,r.useRef)(1e3*(o||y(5,10))),p=(0,r.useState)("move"),v=(0,f.Z)(p,2),b=v[0],h=v[1],g=(0,r.useRef)(0),j=(0,r.useRef)(0),O=(0,r.useRef)(0);(0,r.useEffect)((function(){var e=s.current,t=n||document.getElementById("screen");if(e&&t){var r=y(14,28),o="#"+Math.floor(16777215*Math.random()).toString(16),u=-e.clientWidth,c=y(0,t.clientHeight-e.clientHeight);l({fontSize:r,color:o,right:u,top:c}),O.current=t.clientWidth-u}}),[n]),(0,r.useEffect)((function(){var e=s.current;if("pause"!==b&&e&&n){var t=O.current,r=d.current,o=0,c=0;return c=requestAnimationFrame((function n(a){g.current=g.current||a;var i=g.current,l=j.current;o=t*(l=l+a-i)/r,o=Math.min(o,t),e.style.transform="translateX(-"+o+"px)",g.current=a,j.current=l,l<r?c=requestAnimationFrame(n):setTimeout((function(){u&&u()}),0)})),function(){c&&cancelAnimationFrame(c)}}}),[n,u,b]);var w=(0,r.useCallback)((function(){h("pause")}),[]),x=(0,r.useCallback)((function(){h("move"),g.current=0}),[]);return(0,m.jsx)("span",{ref:s,className:"danmaku",style:i,onMouseEnter:w,onMouseOut:x,children:t})}var v=function(e){var t=function(t){var n=(0,r.useMemo)((function(){var e=document.getElementById("screen");return e||((e=document.createElement("div")).id="screen",e.classList.add("screen"),document.body.appendChild(e)),e}),[]);return d.createPortal((0,m.jsx)(e,(0,s.Z)((0,s.Z)({},t),{},{container:n})),n)};return(0,r.memo)(t)}(p),b=(0,r.memo)(p);v.launch=function(e){var t=(0,r.forwardRef)((function(t,n){return(0,m.jsx)(v,(0,s.Z)({},e))}));(l=l||o.createRoot(document.getElementById("screen"))).render((0,m.jsx)(t,{}))};var h=function(){var e=(0,r.useRef)(""),t=(0,r.useRef)(0),n=(0,r.useRef)(null),o=(0,r.useState)([]),u=(0,f.Z)(o,2),c=u[0],a=u[1],l=(0,r.useCallback)((function(){e.current&&a((function(n){return[].concat(i(n),[{id:t.current++,words:e.current}])}))}),[]),s=(0,r.useCallback)((function(){a([])}),[]),d=(0,r.useCallback)((function(t){e.current=t.target.value}),[]),y=(0,r.useCallback)((function(e){a((function(t){return t.filter((function(t){return e.id!==t.id}))}))}),[]);return(0,m.jsxs)("div",{className:"danmaku-wall",children:[(0,m.jsx)("div",{ref:n,id:"screen",className:"screen",children:c.map((function(e){return(0,m.jsx)(b,{words:e.words,container:n.current,onEnd:function(){return y(e)}},e.id)}))}),(0,m.jsxs)("div",{className:"text-center control-panel",children:[(0,m.jsx)("input",{type:"text",placeholder:"\u8bf7\u8f93\u5165\u5f39\u5e55\u5185\u5bb9",maxLength:50,onChange:d}),(0,m.jsxs)("div",{children:[(0,m.jsx)("button",{className:"primary",type:"button",onClick:l,children:"\u53d1\u5c04"}),(0,m.jsx)("button",{className:"clean",type:"button",onClick:s,children:"\u6e05\u5c4f"})]})]})]})};o.createRoot(document.getElementById("root")).render((0,m.jsx)(r.StrictMode,{children:(0,m.jsx)(h,{})})),(0,u.Z)()},8983:function(e,t,n){t.Z=function(e){e&&e instanceof Function&&n.e(787).then(n.bind(n,787)).then((function(t){var n=t.getCLS,r=t.getFID,o=t.getFCP,u=t.getLCP,c=t.getTTFB;n(e),r(e),o(e),u(e),c(e)}))}},1250:function(e,t,n){var r=n(4164);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},6374:function(e,t,n){var r=n(2791),o=Symbol.for("react.element"),u=Symbol.for("react.fragment"),c=Object.prototype.hasOwnProperty,a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var r,u={},l=null,f=null;for(r in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(f=t.ref),t)c.call(t,r)&&!i.hasOwnProperty(r)&&(u[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===u[r]&&(u[r]=t[r]);return{$$typeof:o,type:e,key:l,ref:f,props:u,_owner:a.current}}t.jsx=l,t.jsxs=l},184:function(e,t,n){e.exports=n(6374)},9829:function(){},907:function(e,t,n){function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{Z:function(){return r}})},8683:function(e,t,n){function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}n.d(t,{Z:function(){return u}})},885:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(181);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,u=[],c=!0,a=!1;try{for(n=n.call(e);!(c=(r=n.next()).done)&&(u.push(r.value),!t||u.length!==t);c=!0);}catch(i){a=!0,o=i}finally{try{c||null==n.return||n.return()}finally{if(a)throw o}}return u}}(e,t)||(0,r.Z)(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},181:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(907);function o(e,t){if(e){if("string"===typeof e)return(0,r.Z)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,r.Z)(e,t):void 0}}}},function(e){var t;t=4292,e(e.s=t)}]);
//# sourceMappingURL=danmaku-wall.8975064e.js.map